---
title: 源码泄露
date: {{ date }}
top: false
cover: false
password:
toc: true
mathjax: true
summary:
tags: [CTF,源码泄露]
categories: [CTF,源码泄露]
---

# Web源码泄露总结

## Git源码泄露

- 漏洞成因：运行git init初始化代码库的时候，会在当前目录下产生一个.git的隐藏文件，用来记录代码的变更记录等等。在发布代码的时候，如果该文件没有删除而是直接发布了，那么使用这个文件，就可以回复代码
- 漏洞利用：工具：[Githacker](https://github.com/wangyihang/githacker)、Githack

## SVN导致文件泄露

- 漏洞利用：工具：dvcs-ripper、Seay-Svn

## HG源码泄露(目前还未遇到)

- 漏洞成因：hg init的时候会生成.hg
- 漏洞利用：工具：dvcs-ripper

## CVS泄露

漏洞利用 
测试的目录

```
http://url/CVS/Root 返回根信息 http://url/CVS/Entries 返回所有文件的结构
```

取回源码的命令

```
bk clone http://url/name dir
```

这个命令的意思就是把远端一个名为name的repo clone到本地名为dir的目录下。

查看所有的改变的命令，转到download的目录

```
bk changes
```

## Bazaar/bzr

工具：

[dvcs-ripper](https://github.com/kost/dvcs-ripper)

```
rip-bzr.pl -v -u http://www.example.com/.bzr/
```

## 网站备份压缩文件

常见备份文件类型总结* .git .svn  .swp .~bak .bash_history

### .phps(dotphps)源码泄露

- phps即为 PHP Source。PHP Source 由 The PHP Group 发布，是最通用的关联应用程序。

- phps文件就是php的源代码文件，通常用于提供给用户（访问者）查看php代码，因为用户无法直接通过Web浏览器看到php文件的内容，所以需要用phps文件代替。其实，只要不用php等已经在服务器中注册过的MIME类型为文件即可，但为了国际通用，所以才用了phps文件类型。

- Mine type: text/html, application/x-httpd-php-source, application/x-httpd-php3-source

- 不是默认存在，只会在特殊情况下存在

  > 参考
  >
  > https://filext.com/file-extension/PHPS
  >
  > [文件扩展名 PHPS](https://www.solvusoft.com/zh-cn/file-extensions/file-extension-phps/)

## WEB-INF/web.xml泄露

WEB-INF是Java的WEB应用的安全目录。如果想在页面中直接访问其中的文件，必须通过web.xml文件对要访问的文件进行相应映射才能访问。

WEB-INF主要包含一下文件或目录：

- `/WEB-INF/web.xml`：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。
- `/WEB-INF/classes/`：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中
- `/WEB-INF/lib/`：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件
- `/WEB-INF/src/`：源码目录，按照包名结构放置各个java文件。
- `/WEB-INF/database.properties`：数据库配置文件

 漏洞成因：

 通常一些web应用我们会使用多个web服务器搭配使用，解决其中的一个web服务器的性能缺陷以及做均衡负载的优点和完成一些分层结构的安全策略等。在使用这种架构的时候，由于对静态资源的目录或文件的映射配置不当，可能会引发一些的安全问题，导致web.xml等文件能够被读取。
 漏洞检测以及利用方法：
 通过找到web.xml文件，推断class文件的路径，最后直接class文件，在通过反编译class文件，得到网站源码。

​	一般情况，jsp引擎默认都是禁止访问WEB-INF目录的，Nginx  配合Tomcat做均衡负载或集群等情况时，问题原因其实很简单，Nginx不会去考虑配置其他类型引擎（Nginx不是jsp引擎）导致的安全问题而引入到自身的安全规范中来（这样耦合性太高了），修改Nginx配置文件禁止访问WEB-INF目录就好了： location ~ ^/WEB-INF/* { deny all; } 或者return 404; 或者其他！

## DS_Store文件泄露

- 漏洞成因：在发布代码的时候未删除隐藏文件汇总的.DS_Store文件，然后攻击者获得了敏感文件等信息
- 漏洞利用：ds_store_exp

## 常见编辑器文件泄露

- vim临时文件(.swp)
- vim备份文件(~)

## Github导致文件泄露

> 参考
>

